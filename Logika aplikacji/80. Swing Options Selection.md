poniÅ¼ej masz **opis warstwy â€Swing Options Selectionâ€** jako rozszerzenie procesu Blueprint (czyli *po* `Setup Planned`, zanim w ogÃ³le myÅ›lisz o wejÅ›ciu). Trzymam siÄ™ wyÅ‚Ä…cznie tego, co Blueprint mÃ³wi o wyborze kontraktu: **czas (DTE), strike (ATM/slightly ITM), pÅ‚ynnoÅ›Ä‡ (spread/volume/OI), unikanie far OTM, oraz kontekst IV/pricing**.

---

## Swing Options Selection (Contract Selection Layer)

### Cel warstwy

ZamieniÄ‡ `PLANNED setup (ticker + teza + invalidacja + targety)` na **konkretny kontrakt opcyjny**, ktÃ³ry:

* ma **czas na realizacjÄ™ tezy** (redukuje presjÄ™ thety),
* ma **wykonywalnÄ… pÅ‚ynnoÅ›Ä‡** (Å¼eby nie traciÄ‡ edge na fillach),
* ma **sensownÄ… ekspozycjÄ™ kierunkowÄ…** (ATM / lekko ITM, nie far OTM).

---

## 1) WejÅ›cie do warstwy (input contract selector)

Warstwa uruchamia siÄ™ **tylko dla setupÃ³w**, ktÃ³re przeszÅ‚y wczeÅ›niejszy filtr i sÄ… w stanie:

* `PLANNED` (lub `OBSERVATION_ONLY`, jeÅ›li chcesz pozwoliÄ‡ na podglÄ…d, ale bez aktywacji). 

Inputy wymagane z setupu:

* `ticker`, `direction` (calls/puts), `timeframe` (swing), `invalidation`, `targets`, `marketPermission/weeklyMode`.

---

## 2) DTE Selection (czas na ruch)

Blueprint dla swingÃ³w uÅ¼ywa **1â€“2 tygodni expiracji** jako standard (czasem same-week, gdy warunki to uzasadniajÄ…).

Output tej fazy:

* `recommended_dte_bucket` (np. `7-14 DTE` jako domyÅ›lne)
* `expiry_candidates[]` (najbliÅ¼sze expiracje speÅ‚niajÄ…ce warunek)

Reason codes (jeÅ›li blokuje/obniÅ¼a):

* `NO_SUITABLE_EXPIRY` (brak sensownej expiracji pod swing w dostÄ™pnych danych)

---

## 3) Strike Selection (ATM / slightly ITM)

Blueprint: wybÃ³r strikeâ€™a ma byÄ‡ **ATM lub lekko ITM**; unika siÄ™ â€lotteryâ€ far OTM, bo tanie kontrakty szybciej karzÄ… wahanie i thetÄ™.

Output tej fazy:

* `strike_candidates[]` (ATM + 1â€“2 lekko ITM)
* tag: `strike_policy = ATM_OR_SLIGHT_ITM`

Reason codes:

* `FAR_OTM_DISALLOWED`

---

## 4) Liquidity Gate (options chain quality)

To jest **twardy gate**: jeÅ›li pÅ‚ynnoÅ›Ä‡ kontraktu jest zÅ‚a, kontrakt odpada niezaleÅ¼nie od tego, jak dobry jest setup. Blueprint explicite kaÅ¼e sprawdzaÄ‡: **tight bid/ask, volume, open interest**.

Checks (minimum):

* `bid_ask_spread_ok`
* `oi_ok`
* `volume_ok`

Output:

* `liquidity_pass=true/false`
* `liquidity_metrics` (spread, OI, volume)

Reason codes:

* `WIDE_SPREAD`
* `LOW_OPEN_INTEREST`
* `LOW_VOLUME`
* `ILLQ_CHAIN`

---

## 5) IV / Pricing Context Check (Options Environment)

Blueprint dodaje filtr Å›rodowiska: zanim wybierzesz kontrakt, oceniasz czy **kontekst IV/wyceny** wspiera trade (long premium vs ryzyka â€pricing trapâ€). JeÅ›li nie wspiera â†’ redukcja lub blokada.

Output:

* `iv_context_tag` (np. `OK` / `RISK`)
* `pricing_gate_pass=true/false` (w MVP moÅ¼e byÄ‡ manual)

Reason codes:

* `IV_PRICING_RISK`

---

## 6) Contract Ranking (wybÃ³r 1 kontraktu)

JeÅ›li kilka kontraktÃ³w przechodzi, system wybiera **najlepszy** wedÅ‚ug prostego rankingu Blueprint:

* preferuj **najciaÅ›niejszy spread** + **najwyÅ¼szy OI/volume** w ramach ATM/slightly ITM i wybranego DTE.

Output:

* `selected_contract` (expiry, strike, call/put)
* `alternates[]` (2â€“3 backupi)

---

## 7) Final Contract Status (wynik warstwy)

Warstwa zwraca jeden z wynikÃ³w:

* `CONTRACT_SELECTED` (moÅ¼na aktywowaÄ‡ trade, jeÅ›li reszta procesu pozwala)
* `CONTRACT_BLOCKED` (setup nie moÅ¼e byÄ‡ aktywowany z powodu kontraktu)
* `CONTRACT_REDUCED` (opcjonalnie: jeÅ›li pricing/IV ryzykowne â†’ tylko observation/reduced)

Zawsze z `reason_codes[]`.

---

## 8) Minimalny UI dla tej warstwy

W Setup Wizard dodajesz krok **â€œContractâ€** po Evaluate:

* picker expiracji (z rekomendacjÄ… 7â€“14 DTE) 
* lista strikeâ€™Ã³w (ATM/slightly ITM) 
* tabelka liquidity (spread/OI/volume) + PASS/FAIL 
* IV/pricing tag (manual w MVP) + gate 
* wynik: `Selected / Blocked` + powody





z Blueprinta moÅ¼na jeszcze wyciÄ…gnÄ…Ä‡ kilka subtelnych, ale waÅ¼nych elementÃ³w, ktÃ³re nie sÄ… wprost techniczne, ale wpÅ‚ywajÄ… na wybÃ³r kontraktu.

PoniÅ¼ej wypisujÄ™ **tylko brakujÄ…ce elementy**, bez rozpisywania nadmiernej teorii.

---

# ğŸ” Co jeszcze moÅ¼na wyciÄ…gnÄ…Ä‡ z Blueprinta

## 1) Dopasowanie DTE do charakteru ruchu (nie tylko 7â€“14 DTE)

W Blueprint:

* DTE nie jest tylko â€œ1â€“2 tygodnieâ€.
* Ma byÄ‡ dopasowane do **oczekiwanego tempa ruchu** (impuls vs grind).

BrakujÄ…cy element:

* `expected_move_speed_tag` (impulse / grind)
* DTE alignment check (czy czas jest adekwatny do charakteru tezy)

Reason code:

* `DTE_MISMATCH_WITH_THESIS_SPEED`

---

## 2) Theta Pressure Awareness (nie tylko â€œczas na ruchâ€)

Blueprint podkreÅ›la:

> krÃ³tsze DTE = wiÄ™ksza presja czasu.

Brakuje jawnej kontroli:

* czy wybrany kontrakt nie wprowadza nadmiernej presji thety wzglÄ™dem typu setupu.

Reason code:

* `EXCESSIVE_THETA_PRESSURE`

---

## 3) Delta / Sensitivity Awareness

ChoÄ‡ Blueprint nie formalizuje greckich jak system quant, implicitnie:

* ATM/slightly ITM ma zapewniaÄ‡ **sensownÄ… reakcjÄ™ na ruch ceny**.

Brakuje:

* prostego `delta_sanity_check` (np. czy kontrakt nie jest zbyt maÅ‚o responsywny)

Reason code:

* `INSUFFICIENT_DIRECTIONAL_SENSITIVITY`

---

## 4) Strike vs Invalidation Logic Alignment

Kontrakt powinien byÄ‡ spÃ³jny z:

* poziomem invalidacji,
* oczekiwanym targetem.

Czyli:

* czy wybrany strike pozwala zrealizowaÄ‡ asymetriÄ™ wynikajÄ…cÄ… z setupu.

BrakujÄ…cy element:

* `strike_invalidation_alignment_check`

Reason code:

* `STRIKE_MISALIGNED_WITH_STRUCTURE`

---

## 5) Risk in Premium Terms (konwersja strukturalnego ryzyka)

Blueprint mÃ³wi: risk wynika z struktury, nie z procenta.
W opcjach to znaczy:

* czy strata premium odpowiada realnemu riskowi wynikajÄ…cemu z invalidacji.

Brakuje:

* `premium_vs_structural_risk_check`

Reason code:

* `PREMIUM_RISK_DISPROPORTIONATE`

---

## 6) Unikanie kontraktÃ³w â€œzbyt tanichâ€

Blueprint ostrzega przed far OTM nie tylko dlatego, Å¼e to lottery, ale dlatego, Å¼e:

* niska cena â‰  dobra asymetria.

MoÅ¼na dodaÄ‡:

* `cheap_contract_trap_check`

Reason code:

* `LOTTERY_PROFILE`

---

## 7) SpÃ³jnoÅ›Ä‡ kontraktu z Market Permission

Masz to implicitnie, ale nie jawnie.

Powinno byÄ‡:

* jeÅ›li `MarketPermission = REDUCED`

  * preferuj dÅ‚uÅ¼sze DTE
  * unikaj agresywnych same-week
* jeÅ›li `BLOCKED`

  * kontrakt selection nie powinien pozwoliÄ‡ na `CONTRACT_SELECTED`

Reason code:

* `CONTRACT_CONFLICTS_WITH_MARKET_PERMISSION`

---

## 8) Execution Quality Risk (spread impact na RR)

Nie chodzi tylko o liquidity pass/fail.

Brakuje:

* wpÅ‚ywu spreadu na realny RR (slippage-adjusted RR)

Reason code:

* `SPREAD_DEGRADES_RR`

---
